{% extends 'projects/base.html' %}
{% load humanize %}
{% block content %}
<div class="form-card" style="max-width: 900px; margin: 0 auto;">
    <h2>üì¶ Rendel√©s K√∂lts√©gvet√©sb≈ël</h2>
    <p>V√°laszd ki azokat a t√©teleket, amelyeket meg szeretn√©l rendelni!</p>

    <form method="POST">
        {% csrf_token %}
        <table class="excel-table">
            <thead>
                <tr>
                    <th style="width:40px;"><input type="checkbox" onclick="toggleAll(this)"></th>
                    <th>Megnevez√©s</th>
                    <th>Mennyis√©g</th>
                    <th>Anyag√°r (Terv)</th>
                </tr>
            </thead>
            <tbody>
                {% for t in tasks %}
                <tr>
                    <td style="text-align:center;"><input type="checkbox" name="selected_items" value="{{ t.id }}"></td>
                    <td>{{ t.leiras }}</td>
                    <td>{{ t.mennyiseg }} {{ t.egyseg }}</td>
                    <td>{{ t.anyag_egysegar|floatformat:0|intcomma }} Ft</td>
                </tr>
                {% empty %}
                <tr><td colspan="4" style="text-align:center; padding:20px;">Nincs anyagk√∂lts√©g a k√∂lts√©gvet√©sben.</td></tr>
                {% endfor %}
            </tbody>
        </table>

        <div style="margin-top:20px; text-align:right;">
            <a href="{% url 'project-detail' project.id %}" class="btn btn-secondary">M√©gse</a>
            <button type="submit" class="btn btn-primary">Rendel√©s Gener√°l√°sa ¬ª</button>
        </div>
    </form>
</div>

<script>
    function toggleAll(source) {
        checkboxes = document.getElementsByName('selected_items');
        for(var i=0, n=checkboxes.length;i<n;i++) { checkboxes[i].checked = source.checked; }
    }
</script>
{% endblock %}